<!-- display pop up for parent info -->

<script>

    var substringMatcher = function(strs) {
        return function findMatches(q, cb) {
            var matches, substringRegex;

            // an array that will be populated with substring matches
            matches = [];

            // regex used to determine if a string contains the substring `q`
            substrRegex = new RegExp(q, 'i');

            // iterate through the pool of strings and for any string that
            // contains the substring `q`, add it to the `matches` array
            $.each(strs, function(i, str) {
                if (substrRegex.test(str)) {
                    matches.push(str);
                }
            });

            cb(matches);
        };
    };

    var mothersHelp = [{% for ped in pedigrees.all %}{% if ped.sex == 'female' and ped.reg_no != pedigree.reg_no %}'{{ ped.reg_no }}', {% endif %}{% endfor %}];
    $('#mothers_div .typeahead').typeahead({
        hint: true,
        highlight: true,
        minLength: 1
    },
    {
        name: 'mothers',
        source: substringMatcher(mothersHelp)
    });

    console.log(mothersHelp)
</script>

<!-- <script>
    
    $('#mother-info').on('click', '.suggested-mother', function() {
        // display reg number in input field
        $('#id_mother').val($(this).attr('id'))
        // just display the info of that pedigree
        $('#mother-info').html('<li class="text-muted row"><div class="col-1"><i class="ti-angle-right"></i></div><div class="col-11"><strong>Name:</strong> ' + $(this).attr('name') + '<strong><br/>Reg #:</strong> ' + $(this).attr('id') + '</div></li>');
    })

    $('#id_mother').bind('keyup change click', function(event) {
        $.ajax({
            url: "{% url 'get_pedigree_details' %}",
            type: 'GET',
            headers: {'X-CSRFToken': '{{ csrf_token }}'},
            dataType: 'text',
            data: {'id': $(this).val()},
            success: function(data) {
                result = JSON.parse(data);
                if (result.result == 'success') {
                    // don't display names if no text in field
                    if ($('#id_mother').val() != '') {
                        // display full match
                        if (result.pedigree) {
                            mother_array = JSON.parse(result.pedigree)
                            mother = mother_array[0]
                            // if item is complete
                            $('#mother-info').html('<li class="text-muted row"><div class="col-1"><i class="ti-angle-right"></i></div><div class="col-11"><strong>Name:</strong> ' + mother.fields.name + '<strong><br/>Reg #:</strong> ' + mother.fields.reg_no + '</div></li>');
                            $('#mother-info').removeClass('d-none');
                        }
                        // display partial matches
                        else if (result.pedigrees) {
                            mother_array = JSON.parse(result.pedigrees)
                            motherInfoHtml = ''
                            mother_array.forEach( mother => {
                                motherInfoHtml = motherInfoHtml + '<li id="' + mother.fields.reg_no + '" name="' + mother.fields.name + '" class="text-muted row suggested-mother" style="cursor: pointer"><div class="col-1"><i class="ti-angle-right"></i></div><div class="col-11"><strong>Name:</strong> ' + mother.fields.name + '<strong><br/>Reg #:</strong> ' + mother.fields.reg_no + '</div></li>'
                            })
                            $('#mother-info').html(motherInfoHtml)
                            $('#mother-info').removeClass('d-none')
                        }
                    } else {
                        // hide info
                        $('#mother-info').addClass('d-none');
                    }
                } else {
                    // hide info
                    $('#mother-info').addClass('d-none');
                }
            }
        });
    });

    $('#id_father').bind('keyup change click', function(event) {
        $.ajax({
            url: "{% url 'get_pedigree_details' %}",
            type: 'GET',
            headers: {'X-CSRFToken': '{{ csrf_token }}'},
            dataType: 'text',
            data: {'id': $(this).val()},
            success: function(data) {
                result = JSON.parse(data);

                if (result.result == 'success') {
                    father_array = JSON.parse(result.pedigree)
                    father = father_array[0].fields
                    // if item is complete
                    $('#father-name').html(father.name);
                    $('#father-info').removeClass('d-none');
                } else {
                    // hide info
                    $('#father-info').addClass('d-none');
                }
            }
        });
    });
</script> -->